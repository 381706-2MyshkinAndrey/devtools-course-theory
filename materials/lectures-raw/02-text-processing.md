# Обработка текста

![](./02-text-processing/carpentry-tools.jpg)

Кирилл Корняков (Itseez, ННГУ)  
Сентябрь 2013

<!--   01. Обработка текста / Текстовые редакторы
      - Редакторы: vim, Emacs, Sublime
      - Манипуляции (навигация, сортировка, сниппеты и макросы)
      - Regular expressions
      - Консольные инструменты

TODO
 - мб вставить интересные факты
 - кривые обучения
 - вызов текстового редактора из командной строки
 - Как насчет всего закомментированного кода
-->

# Содержание

  1. Текстовые редакторы
  2. Возможности современных редакторов (на примере Sublime)
  3. Регулярные выражения
  4. Инструменты командной строки
  5. Краткое упоминание про скриптовые языки

# Два совета

> 1. Освойте слепой метод печати
     - Вы начинаете работать "со скоростью мысли"
     - Мозгу не нужно переключаться, вы фокусируетесь на задаче
     - Это полезно для глаз
     - Тренажеры: [русский](http://vse10.ru),
       [английский](http://www.ratatype.com)
  2. Избегайте использования мыши
     - Экономия до 30% рабочего времени
     - Освойте клавиатурные комбинации ("горячие клавиши")

# Текстовые редакторы

"Программист-прагматик":

> Используйте один текстовый редактор, но по максимуму.

**Важные свойства:**

 - Кросс-платформенность
 - Настраиваемость
    - Шрифты, оформление, клавиатурные комбинации
 - Расширяемость
    - Новые языки программирования и форматы файлов
 - Программируемость
    - Программируемость сложных операций (макросы, сценарии)
 - Скорость

# Vim

+--------------------------------------+------------------------------------------------------------------------------+
|![](./02-text-processing/vim-logo.png)| - Vim - свободный текстовый редактор, созданный на базе vi.                  |
|                                      | - Один из мощнейших редакторов, с полной свободой настройки и автоматизации. |
|                                      | - Имеет огромное количество расширений (более 3000).                         |
|                                      | - Используется практически в любых проектах.                                 |
|                                      | - Один из культовых редакторов.                                              |
|                                      | - Официальный сайт проекта: <http://www.vim.org>.                            |
+--------------------------------------+------------------------------------------------------------------------------+

# Vim UI

![](./02-text-processing/vim3.gif)

# Vim Cheatsheet

![](./02-text-processing/vi-vim-cheat-sheet.gif)

# Vim examples

**TBD**

+-----------------------------------+----------------------------------------------------------------------------+

+-----------------------------------+----------------------------------------------------------------------------+


# Emacs

+-----------------------------------+----------------------------------------------------------------------------+
|![](./02-text-processing/emacs.png)| - Emacs - семейство расширяемых многофункциональных текстовых редакторов.  |
|                                   | - Возможно еще более мощный редактор, чем Vim (Emacs as OS).               |
|                                   | - Имеет более 2000 встроенных команд, позволяет комбинировать их в макросы.|
|                                   | - Второй культовый редактор.                                               |
|                                   | - Официальный сайт проекта <http://www.gnu.org/software/emacs/>.           |
+-----------------------------------+----------------------------------------------------------------------------+

# Emacs UI

![](./02-text-processing/Emacs-screenshot.png)

# Идеология Emacs

  - «Всё в одном»
    - Функциональность: базовая, основной режим, дополнительные режимы
  - Расширяемость
    - Программируется на Elisp, имеются пакеты расширений, клавиатурные
      комбинации
  - Настраиваемость под пользователя
    - Elisp-переменные, определение функций, создание hook'ов
  - Документированность
    - Подробная документация, вплоть до функций и переменных

# Sublime Text

+------------------------------------------+--------------------------------------------------------------+
|![](./02-text-processing/sublime-logo.png)| - Sublime Text - кроссплатформенный редактор текста и кода.  |
|                                          | - Имеет Python API, существует большое количество раширений. |
|                                          | - Не является свободным, однако почти все расширения открыты.|
|                                          | - Становится все более популярным.                           |
|                                          | - Официальный сайт проекта <http://www.sublimetext.com/>.    |
+------------------------------------------+--------------------------------------------------------------+

# Sublime Text UI

![](./02-text-processing/SublimeText2.png)

# Sublime Text Горячие клавиши

![](./02-text-processing/sublime_help.png)

# Типичные операции

  - Навигация
  - Выделение
  - Поиск
  - Редактирование

# Навигация

  1. По файлам
     - Перебор закладок
     - Боковая панель
     - **Go to anything**
  1. Внутри файлов
     - Хождение по словам, строкам, экрану
     - Переход на строку
     - Переход между скобками
     - **Go to symbol**

# Выделение

  1. Слов, Строк
  1. Абзацев
  1. Выражений внутри скобок
  1. Всех вхождений слова => Поиск

# Поиск

  1. Простой поиск
     - **Multiple cursor**
     - **Регулярные выражения**
  1. Инкрементальный
  1. Быстрый

# Редактирование
  
  1. Комментирование
  1. Перестановка двух символов
  1. Удаление: слов, строк, окончаний строк
  1. Манипуляции со строками
     - Дублирование, переупорядочение, сортировка
     - Слияние и автоматический перенос
  1. Редактирование нескольких строк и прямоугольных регионов

# Продвинутые возможности

  1. Package Control
  1. Snippets
  1. Vintage Mode
  1. Custom Builds
  1. Projects

# Регулярные выражения

> **Регулярные выражения** (англ. regular expressions) — формальный язык поиска
и осуществления манипуляций с подстроками в тексте, основанный на использовании
метасимволов (англ. wildcard characters).

> По сути это строка-образец (англ. pattern, по-русски её часто называют
«шаблоном», «маской»), состоящая из символов и метасимволов и задающая правило
поиска.

Wikipedia

Метасимволы: `[ ] \ / ^ $ . | ? * + ( ) { }`

# Примеры регулярных выражений

(Даются упрощенные выражения)

> - Email: `[a-z]+@[a-z]+\.com`
  - Visa: `4[0-9]{3}(\ [0-9]{4}){3}`
  - IP: `\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b`
  - Float: `[-+]?[0-9]+\.[0-9]+`
  - Years old:
    - `[0-9]{2}(?=\ years)`
    - `(?<=[0-9]{4}\ \()[0-9]{2}`

# Синтаксис

> - Обычные строки обозначают сами себя
  - `\` - экранирует спецсимволы (`/` иногда используется как разделитель)
  - `.` - может быть использована вместо любого символа 
  - `( )` - группировка, указывает приоритет операций
  - `[ ]` - обозначает символьный класс (`[abc], [0123456789], [а-я], [0-9]`)
  - `^ $` - указывают на начало и конец строки
  - `? * + { }` - указывают число повторений

<!-- What is |  -->

# Примеры регулярных выражений

Что ищут эти выражения, и какие они имеют недостатки?

> - `[a-z]+@[a-z]+\.com`
  - `4[0-9]{3}(\ [0-9]{4}){3}`
  - `\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b`
  - `[-+]?[0-9]+\.[0-9]+`
  - Lookaround
    - lookahead: `[0-9]{2}(?=\ years)`
    - lookbehind: `(?<=[0-9]{4}\ \()[0-9]{2}`

# Инструменты командной строки

  1. Просмотр
     - `cat`, `head/tail`, `less`
  1. Поиск
     - `grep`
  1. Обработка
     - `sed`, `awk`

# Скриптовые языки

> - Perl 
    - Practical Extraction and Report Language 
    - Создан Ларри Уоллом, лингвистом по образованию
    - Замена для `awk` и `sed`
    - Богатые возможности по работе с текстом,  
      встроенная в синтаксис поддержка регулярных выражений
  - Python
    - Есть мнение, что он все-таки победил как язык общего назначения

# Резюме

  1. Освойте слепой метод набора текста
  1. Выберите себе текстовый редактор, и изучите его досконально
     - Попробуйте программировать в текстовом редакторе
  1. Распечатайте шпаргалку с горячими клавишами
     - Постарайтесь не использовать мышь для навигации, выделения
  1. Освойте регулярные выражения
     - Используйте их для поиска и замены, пакетной обработки файлов
  1. Установите и изучите инструменты командной строки
     - cat, less, head/tail
     - grep, sed, awk

# Контрольные вопросы

  1. Как будет выглядет команда в Vim для:
     - Создания 10 копий текущей строки
     - Перевода всей строки в верхний регистр (капитализация)
  1. Предложите регулярное выражение для поиска:
     - Имен всех классов в вашем С++ проекте
     - Поиска всех дат в формате 2013-09-18 или 14-01-01
  1. Предложите командную строку для:
     - Поиска всех вызовов виртуального метода в директории с исходниками
     - Печати всех заголовков первого и второго уровня в файле Markdown (#-нотация)

# Спасибо!

Вопросы?